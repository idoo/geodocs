(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};this.TheSortableTree=function(){function r(){this.rebuild=e(this.rebuild,this)}var t,n;return t=3,n="/",r.prototype.init=function(){var e=this;return $("ol.sortable").nestedSortable({disableNesting:"no-nest",forcePlaceholderSize:!0,handle:"i.handle",helper:"clone",items:"li",maxLevels:this.max_levels,opacity:.6,placeholder:"placeholder",revert:250,tabSize:25,tolerance:"pointer",toleranceElement:"> div"}),$("ol.sortable").sortable({update:function(t,n){var r,i,s,o;return s=n.item.parent().parent().attr("id"),r=n.item.attr("id"),o=n.item.prev().attr("id"),i=n.item.next().attr("id"),e.rebuild(r,s,o,i)}})},r.prototype.rebuild=function(e,t,n,r){return $.ajax({type:"POST",dataType:"script",url:this.rebuild_url,data:{id:e,parent_id:t,prev_id:n,next_id:r},beforeSend:function(e){return $(".nested_set i.handle").hide()},success:function(e,t,n){return $(".nested_set i.handle").show()},error:function(e,t,n){return alert(n)}})},r}()}).call(this);